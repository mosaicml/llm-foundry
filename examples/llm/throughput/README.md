## Warning: Some of the numbers below, particularly for 30B and 70B models, are out of date. The current repo achieves higher throughput / MFU. This warning will be removed once the tables are updated.

# MosaicGPT Training Benchmarks

Benchmark measurements for MosaicGPT models trained on [MosaicML Cloud](https://www.mosaicml.com/cloud), including throughput, MFU, and HFU. Each model is based on optimized configurations of various sizes in the [yamls](../yamls) folder, ranging from a 125m to 70B parameter models.

To reproduce these results, first:
```
python submit_benchmarks.py -m 125m.yaml --cluster [your_mosaicml_cluster] --RUN
```

will use our Python API to submit a sweep of configurations for the 125M parameter model. To run all the configurations, omit the `-m` flag.

Then, after the runs are completed:
```
python collect_results.py --save-path results
```
will use our Python API to collect and calculate the benchmark results, and then save as both a CSV file `results.csv`, and a markdown table `results.md`.

> **Note**
> The `collect_results.py` will by default find all runs with `tput` in the run name. To customize this project tag, use `--project` in both the submissing and collection scripts.


## MFU and HFU

Model FLOPs Utilization (MFU) and Hardware FLOPS Utilization (HFU) are estimates, based on the throughput and the known FLOPs of the computation, of what percentage of the hardware's FLOPs are being used during training.

MFU calculates the utilizaiton from the floating point operations required for a single forward/backwards pass of the model, and do not account for the additional compute required for other implementation details such as activation checkpointing. Thus, MFU is independant of implementation and hardware.

HFU attempt to capture the actual floating point operations incurred during the forward/backwards pass on the hardware, and is a more accurate measurement of hardware utilization, but less general and difficult to compare across various hardware and implementation details.

For more information, see [Korthikanti et al, 2022](https://arxiv.org/abs/2205.05198). All FLOP calculations exclude the operations required for normalization, activation, and residuals.

### MFU

Per token, each parameter is used for a MAC (2 FLOPS) per network operation. Neural Network training has 3 network operations: forward pass, backward pass, and computation of parameter gradient.

The attention mechanism forward pass FLOPS are: `attn_flops_per_seq = n_layers * 2 * 2 * (d_model * (seq_len**2))`
```
flops_per_token = 2 * n_params
flops_per_seq = flops_per_token * seq_len
mfu* = 3 * flops_per_seq * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)

attn_flops_per_seq = n_layers * 2 * 2 * (d_model * (seq_len**2))
mfu = (3 * flops_per_seq + 3 * attn_flops_per_seq) * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
```

### HFU

The HFU numbers shown below account for the fact that the networks use checkpointing and recomputes activations. This effectively requires an extra forward pass through the network.
```
hfu* = 4 * flops_per_seq * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
hfu = (4 * flops_per_seq + 4 * attn_flops_per_seq) * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
```

Note that these are approximations. Actual HFU would be higher since it includes the floating point operations for normalization, activation, and residual lyaers, as well as **all** recomputation. For example, our models use Flash Attention, which requires including an extra recompute factor for its recomputation in the forward pass. Therefore, the attention multipler would be 5 instead of 4.

## Results

Below we include several configurations across different hardware platforms, sequence lengths and batch sizes. It is easy to benchmark configurations for your own use case. For example, using Mosaic Cloud, to test MosaicGPT {13B, 30B} using fp16 with a batch size of 2M tokens and seq len {2k, 4k, 8k, 16k} run:
```
python submit_benchmarks.py -m 13b.yaml 30b.yaml -t fp16 -b 21 21 -s 11 14 --RUN
```
This will run 8 configs for 12 steps to get throughput numbers. `python collect_results.py` can then be used to parse all output training logs and create the tables below.

Sometimes we report Global Batchsizes that are not evenly divisible by the micro batch size. Our microbatching engine allows for non-divisible sizes, while being mathematically faithful to the global batch size. For example, a total batch size of 48, and a micro batch of 11, means we will accumulate gradients across microbatches of 11, 11, 11, 11, 4.

## A100 80GB

Note: The 30B -> 70B measurements below are outdated, and will be updated shortly.

| Model   | SeqLen (T) | GPUType       | MFU    | HFU    | Throughput (T/s) | GPUThroughput (T/s/GPU) | Throughput (S/s) | ParamCount  | GlobalBatchSize (T) | GlobalBatchSize (S) | MicroBatchSize (S) | GradAccum | ShardStrategy | ActCkpt | ActCPUoffload | Precision | MP Mode | NumGPUs | GPUType   |
| ------- | ---------- | ------------- | ------ | ------ | ------ | ------ | ---------------- | ----------------------- | ---------------- | ----------- | ------------------- | ------------------- | ------------------ | --------- | ------------- | ------- | ------------- | --------- | ------- |
|  gpt70b |       2048 | 128xA100_80GB | 0.4265 | 0.5687 |         42028.81 |                328.3501 |          20.5219 | 64861528064 |             2097152 |                1024 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       8192 |  64xA100_80GB | 0.4502 | 0.6003 |         42023.16 |                656.6118 |           5.1298 | 30018458624 |             1048576 |                 128 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt30b |       8192 |  32xA100_80GB | 0.4435 | 0.5914 |         20698.23 |                646.8198 |           2.5266 | 30018458624 |              524288 |                  64 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       4096 | 128xA100_80GB | 0.4649 | 0.6198 |         94312.24 |                736.8144 |          23.0254 | 29989098496 |             2097152 |                 512 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       4096 |  32xA100_80GB | 0.4644 | 0.6192 |         23553.76 |                736.0550 |           5.7504 | 29989098496 |              524288 |                 128 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       2048 | 256xA100_80GB | 0.4674 | 0.6232 |        198267.62 |                774.4829 |          96.8104 | 29974418432 |             4194304 |                2048 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     256 | a100_80gb |
|  gpt30b |       2048 | 128xA100_80GB | 0.4762 | 0.6349 |        100995.65 |                789.0285 |          49.3143 | 29974418432 |             2097152 |                1024 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       2048 |  64xA100_80GB | 0.4777 | 0.6369 |         50651.59 |                791.4310 |          24.7322 | 29974418432 |             1048576 |                 512 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt30b |       2048 |  32xA100_80GB | 0.4796 | 0.6394 |         25427.85 |                794.6202 |          12.4159 | 29974418432 |              524288 |                 256 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       2048 |  16xA100_80GB | 0.4777 | 0.6369 |         12663.75 |                791.4842 |           6.1835 | 29974418432 |              262144 |                 128 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |

The <30B measurements below reflect the latest version of our codebase:

| Model   | SeqLen (T) | \# GPUs | GPU       | MFU   | HFU   | Global BatchSize | Micro BatchSize | GradAccum | Throughput (S/s) | Throughput (T/s) | Throughput (T/s/GPU) | GlobalBatchSize (T) | Precision | MP Mode | Sharding Strategy | Activation Checkpointing | Activation CPUOffload | NumParams   |
| ------- | ---------- | ------- | --------- | ----- | ----- | --------------- | -------------- | --------- | ---------------- | ---------------- | -------------------- | ------------------- | --------- | ------- | ----------------- | ------------------------ | --------------------- | ----------- |
| gpt13b  | 2048       | 8       | a100_80gb | 47.82 | 63.75 | 2048            | 12             | 22        | 7                | 14527            | 1815                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 12853463040 |
| gpt13b  | 2048       | 8       | a100_80gb | 47.82 | 63.76 | 1024            | 12             | 11        | 7                | 14527            | 1815                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 12853463040 |
| gpt13b  | 2048       | 8       | a100_80gb | 47.61 | 63.48 | 512             | 12             | 6         | 7                | 14463            | 1807                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 12853463040 |
| gpt13b  | 2048       | 8       | a100_80gb | 47.59 | 63.45 | 256             | 12             | 3         | 7                | 14457            | 1807                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 12853463040 |
| gpt13b  | 2048       | 16      | a100_80gb | 48.26 | 64.34 | 2048            | 16             | 8         | 14               | 29322            | 1832                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 12853463040 |
| gpt13b  | 2048       | 16      | a100_80gb | 48.25 | 64.34 | 1024            | 16             | 4         | 14               | 29319            | 1832                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 12853463040 |
| gpt13b  | 2048       | 16      | a100_80gb | 48.27 | 64.36 | 512             | 16             | 2         | 14               | 29329            | 1833                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 12853463040 |
| gpt13b  | 2048       | 16      | a100_80gb | 48.22 | 64.29 | 256             | 16             | 1         | 14               | 29298            | 1831                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 12853463040 |
| gpt7b   | 2048       | 8       | a100_80gb | 46.24 | 61.66 | 2048            | 20             | 13        | 13               | 26736            | 3342                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792  |
| gpt7b   | 2048       | 8       | a100_80gb | 46.88 | 62.51 | 1024            | 20             | 7         | 13               | 27104            | 3388                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792  |
| gpt7b   | 2048       | 8       | a100_80gb | 46.29 | 61.72 | 512             | 20             | 4         | 13               | 26761            | 3345                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792  |
| gpt7b   | 2048       | 8       | a100_80gb | 46.53 | 62.04 | 256             | 20             | 2         | 13               | 26900            | 3362                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792  |
| gpt7b   | 2048       | 16      | a100_80gb | 46.44 | 61.92 | 2048            | 20             | 7         | 26               | 53700            | 3356                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792  |
| gpt7b   | 2048       | 16      | a100_80gb | 46.26 | 61.68 | 1024            | 20             | 4         | 26               | 53490            | 3343                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792  |
| gpt7b   | 2048       | 16      | a100_80gb | 46.22 | 61.62 | 512             | 20             | 2         | 26               | 53441            | 3340                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792  |
| gpt7b   | 2048       | 16      | a100_80gb | 46.18 | 61.57 | 256             | 16             | 1         | 26               | 53398            | 3337                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792  |
| gpt3b   | 2048       | 8       | a100_80gb | 51.01 | 51.01 | 2048            | 6              | 43        | 34               | 71045            | 8880                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 2651591680  |
| gpt3b   | 2048       | 8       | a100_80gb | 50.73 | 50.73 | 1024            | 6              | 22        | 34               | 70651            | 8831                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 2651591680  |
| gpt3b   | 2048       | 8       | a100_80gb | 50.94 | 50.94 | 512             | 6              | 11        | 34               | 70945            | 8868                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 2651591680  |
| gpt3b   | 2048       | 8       | a100_80gb | 50.17 | 50.17 | 256             | 6              | 6         | 34               | 69870            | 8733                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 2651591680  |
| gpt3b   | 2048       | 16      | a100_80gb | 49.89 | 49.89 | 2048            | 6              | 22        | 67               | 138946           | 8684                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 2651591680  |
| gpt3b   | 2048       | 16      | a100_80gb | 50    | 50    | 1024            | 6              | 11        | 68               | 139264           | 8704                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 2651591680  |
| gpt3b   | 2048       | 16      | a100_80gb | 49.66 | 49.66 | 512             | 6              | 6         | 67               | 138327           | 8645                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 2651591680  |
| gpt3b   | 2048       | 16      | a100_80gb | 49.63 | 49.63 | 256             | 6              | 3         | 67               | 138222           | 8638                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 2651591680  |
| gpt1b   | 2048       | 8       | a100_80gb | 50.1  | 50.1  | 2048            | 10             | 26        | 67               | 137376           | 17172                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984  |
| gpt1b   | 2048       | 8       | a100_80gb | 49.43 | 49.43 | 1024            | 10             | 13        | 66               | 135530           | 16941                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984  |
| gpt1b   | 2048       | 8       | a100_80gb | 49.81 | 49.81 | 512             | 10             | 7         | 66               | 136572           | 17071                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984  |
| gpt1b   | 2048       | 8       | a100_80gb | 49.54 | 49.54 | 256             | 10             | 4         | 66               | 135854           | 16981                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984  |
| gpt1b   | 2048       | 16      | a100_80gb | 49.47 | 49.47 | 2048            | 10             | 13        | 132              | 271315           | 16957                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984  |
| gpt1b   | 2048       | 16      | a100_80gb | 49.23 | 49.23 | 1024            | 10             | 7         | 131              | 269990           | 16874                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984  |
| gpt1b   | 2048       | 16      | a100_80gb | 48.75 | 48.75 | 512             | 10             | 4         | 130              | 267354           | 16709                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984  |
| gpt1b   | 2048       | 16      | a100_80gb | 48.74 | 48.74 | 256             | 10             | 2         | 130              | 267317           | 16707                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984  |
| gpt760m | 2048       | 8       | a100_80gb | 45.66 | 45.66 | 2048            | 12             | 22        | 101              | 208439           | 26054                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072   |
| gpt760m | 2048       | 8       | a100_80gb | 45.88 | 45.88 | 1024            | 12             | 11        | 102              | 209427           | 26178                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072   |
| gpt760m | 2048       | 8       | a100_80gb | 45.87 | 45.87 | 512             | 12             | 6         | 102              | 209369           | 26171                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072   |
| gpt760m | 2048       | 8       | a100_80gb | 45.81 | 45.81 | 256             | 12             | 3         | 102              | 209104           | 26138                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072   |
| gpt760m | 2048       | 16      | a100_80gb | 45.37 | 45.37 | 2048            | 12             | 11        | 202              | 414201           | 25887                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072   |
| gpt760m | 2048       | 16      | a100_80gb | 44.95 | 44.95 | 1024            | 12             | 6         | 200              | 410357           | 25647                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072   |
| gpt760m | 2048       | 16      | a100_80gb | 45.08 | 45.08 | 512             | 12             | 3         | 200              | 411602           | 25725                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072   |
| gpt760m | 2048       | 16      | a100_80gb | 43.82 | 43.82 | 256             | 12             | 2         | 195              | 400053           | 25003                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072   |
| gpt350m | 2048       | 8       | a100_80gb | 41.02 | 41.02 | 2048            | 16             | 16        | 182              | 373810           | 46726                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104   |
| gpt350m | 2048       | 8       | a100_80gb | 41.4  | 41.4  | 1024            | 16             | 8         | 184              | 377236           | 47154                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104   |
| gpt350m | 2048       | 8       | a100_80gb | 41.22 | 41.22 | 512             | 16             | 4         | 183              | 375552           | 46944                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104   |
| gpt350m | 2048       | 8       | a100_80gb | 41.04 | 41.04 | 256             | 16             | 2         | 182              | 373972           | 46746                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104   |
| gpt350m | 2048       | 16      | a100_80gb | 40.86 | 40.86 | 2048            | 16             | 8         | 363              | 744662           | 46541                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104   |
| gpt350m | 2048       | 16      | a100_80gb | 40.92 | 40.92 | 1024            | 16             | 4         | 364              | 745717           | 46607                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104   |
| gpt350m | 2048       | 16      | a100_80gb | 40.88 | 40.88 | 512             | 16             | 2         | 363              | 744910           | 46556                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104   |
| gpt350m | 2048       | 16      | a100_80gb | 40.77 | 40.77 | 256             | 16             | 1         | 362              | 742945           | 46434                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104   |
| gpt125m | 2048       | 8       | a100_80gb | 34.58 | 34.58 | 2048            | 32             | 8         | 430              | 882486           | 110310               | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760   |
| gpt125m | 2048       | 8       | a100_80gb | 34.64 | 34.64 | 1024            | 32             | 4         | 431              | 884215           | 110526               | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760   |
| gpt125m | 2048       | 8       | a100_80gb | 34.82 | 34.82 | 512             | 32             | 2         | 433              | 888646           | 111080               | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760   |
| gpt125m | 2048       | 8       | a100_80gb | 34.45 | 34.45 | 256             | 32             | 1         | 429              | 879324           | 109915               | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760   |
| gpt125m | 2048       | 16      | a100_80gb | 34.5  | 34.5  | 2048            | 32             | 4         | 860              | 1761358          | 110084               | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760   |
| gpt125m | 2048       | 16      | a100_80gb | 34.51 | 34.51 | 1024            | 32             | 2         | 860              | 1761842          | 110115               | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760   |
| gpt125m | 2048       | 16      | a100_80gb | 34.3  | 34.3  | 512             | 32             | 1         | 854              | 1750997          | 109437               | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760   |
| gpt125m | 2048       | 16      | a100_80gb | 32.54 | 32.54 | 256             | 16             | 1         | 811              | 1661141          | 103821               | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760   |

## A100 40GB

| Model   | SeqLen (T) | \# GPUs | GPU       | MFU   | HFU   | Global BatchSize | Micro BatchSize | GradAccum | Throughput (S/s) | Throughput (T/s) | Throughput (T/s/GPU) | Global BatchSize (T) | Precision | MP Mode | Sharding Strategy | Activation Checkpointing | Activation CPUOffload | NumParams  |
| ------- | ---------- | ------- | --------- | ----- | ----- | --------------- | -------------- | --------- | ---------------- | ---------------- | -------------------- | ------------------- | --------- | ------- | ----------------- | ------------------------ | --------------------- | ---------- |
| gpt7b   | 2048       | 8       | a100_40gb | 42.21 | 56.28 | 2048            | 6              | 43        | 11               | 24404            | 3050                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 8       | a100_40gb | 41.96 | 55.94 | 1024            | 6              | 22        | 11               | 24256            | 3032                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 8       | a100_40gb | 41.96 | 55.95 | 512             | 6              | 11        | 11               | 24261            | 3032                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 8       | a100_40gb | 41.81 | 55.75 | 256             | 6              | 6         | 11               | 24175            | 3021                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 16      | a100_40gb | 43.22 | 57.63 | 2048            | 8              | 16        | 24               | 49977            | 3123                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 16      | a100_40gb | 43.04 | 57.38 | 1024            | 8              | 8         | 24               | 49763            | 3110                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 16      | a100_40gb | 42.94 | 57.26 | 512             | 8              | 4         | 24               | 49654            | 3103                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 16      | a100_40gb | 42.76 | 57.02 | 256             | 8              | 2         | 24               | 49447            | 3090                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 32      | a100_40gb | 42.87 | 57.16 | 2048            | 8              | 8         | 48               | 99133            | 3097                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 32      | a100_40gb | 42.97 | 57.3  | 1024            | 8              | 4         | 48               | 99383            | 3105                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 32      | a100_40gb | 42.95 | 57.27 | 512             | 8              | 2         | 48               | 99328            | 3104                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 32      | a100_40gb | 42.89 | 57.19 | 256             | 8              | 1         | 48               | 99195            | 3099                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt7b   | 2048       | 64      | a100_40gb | 42.37 | 56.5  | 1024            | 8              | 2         | 95               | 195987           | 3062                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 6658465792 |
| gpt3b   | 2048       | 8       | a100_40gb | 39.73 | 52.98 | 2048            | 14             | 19        | 27               | 55335            | 6916                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 8       | a100_40gb | 39.82 | 53.09 | 1024            | 14             | 10        | 27               | 55454            | 6931                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 8       | a100_40gb | 39.68 | 52.91 | 512             | 14             | 5         | 26               | 55259            | 6907                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 8       | a100_40gb | 39.24 | 52.31 | 256             | 14             | 3         | 26               | 54641            | 6830                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 16      | a100_40gb | 39.46 | 52.61 | 2048            | 14             | 10        | 53               | 109905           | 6869                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 16      | a100_40gb | 39.27 | 52.36 | 1024            | 14             | 5         | 53               | 109367           | 6835                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 16      | a100_40gb | 38.77 | 51.69 | 512             | 14             | 3         | 52               | 107971           | 6748                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 16      | a100_40gb | 37.87 | 50.49 | 256             | 14             | 2         | 51               | 105470           | 6591                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 32      | a100_40gb | 37.94 | 50.58 | 2048            | 8              | 8         | 103              | 211333           | 6604                 | 4194304             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 32      | a100_40gb | 38.51 | 51.35 | 1024            | 14             | 3         | 104              | 214529           | 6704                 | 2097152             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 32      | a100_40gb | 37.92 | 50.56 | 512             | 14             | 2         | 103              | 211250           | 6601                 | 1048576             | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt3b   | 2048       | 32      | a100_40gb | 37.68 | 50.25 | 256             | 8              | 1         | 102              | 209919           | 6559                 | 524288              | bf16      | DEFAULT | FULL_SHARD        | TRUE                     | FALSE                 | 2651591680 |
| gpt1b   | 2048       | 8       | a100_40gb | 44.23 | 44.23 | 2048            | 4              | 64        | 59               | 121285           | 15160                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 8       | a100_40gb | 44.32 | 44.32 | 1024            | 4              | 32        | 59               | 121517           | 15189                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 8       | a100_40gb | 44.22 | 44.22 | 512             | 4              | 16        | 59               | 121265           | 15158                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 8       | a100_40gb | 43.73 | 43.73 | 256             | 4              | 8         | 58               | 119913           | 14989                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 16      | a100_40gb | 42.52 | 42.52 | 2048            | 4              | 32        | 113              | 233203           | 14575                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 16      | a100_40gb | 42.54 | 42.54 | 1024            | 4              | 16        | 113              | 233280           | 14580                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 16      | a100_40gb | 42.38 | 42.38 | 512             | 4              | 8         | 113              | 232440           | 14527                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 16      | a100_40gb | 42.35 | 42.35 | 256             | 4              | 4         | 113              | 232270           | 14516                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 32      | a100_40gb | 41.45 | 41.45 | 2048            | 4              | 16        | 222              | 454695           | 14209                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 32      | a100_40gb | 41.84 | 41.84 | 1024            | 4              | 8         | 224              | 458925           | 14341                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 32      | a100_40gb | 41.86 | 41.86 | 512             | 4              | 4         | 224              | 459188           | 14349                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt1b   | 2048       | 32      | a100_40gb | 41.75 | 41.75 | 256             | 4              | 2         | 223              | 457923           | 14310                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 1315753984 |
| gpt760m | 2048       | 8       | a100_40gb | 41.69 | 41.69 | 2048            | 6              | 43        | 92               | 190290           | 23786                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 8       | a100_40gb | 41.94 | 41.94 | 1024            | 6              | 22        | 93               | 191426           | 23928                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 8       | a100_40gb | 41.64 | 41.64 | 512             | 6              | 11        | 92               | 190099           | 23762                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 8       | a100_40gb | 41.14 | 41.14 | 256             | 6              | 6         | 91               | 187790           | 23473                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 16      | a100_40gb | 40.42 | 40.42 | 2048            | 6              | 22        | 180              | 369035           | 23064                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 16      | a100_40gb | 40.32 | 40.32 | 1024            | 6              | 11        | 179              | 368100           | 23006                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 16      | a100_40gb | 40.82 | 40.82 | 512             | 6              | 6         | 181              | 372704           | 23294                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 16      | a100_40gb | 40.01 | 40.01 | 256             | 6              | 3         | 178              | 365250           | 22828                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 32      | a100_40gb | 40.32 | 40.32 | 2048            | 6              | 11        | 359              | 736144           | 23004                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 32      | a100_40gb | 39.67 | 39.67 | 1024            | 6              | 6         | 353              | 724385           | 22637                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 32      | a100_40gb | 39.59 | 39.59 | 512             | 6              | 3         | 352              | 722799           | 22587                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 32      | a100_40gb | 37.52 | 37.52 | 256             | 6              | 2         | 334              | 685107           | 21409                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 64      | a100_40gb | 38.89 | 38.89 | 1024            | 6              | 3         | 693              | 1420188          | 22190                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 64      | a100_40gb | 36.45 | 36.45 | 512             | 6              | 2         | 649              | 1330954          | 20796                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt760m | 2048       | 64      | a100_40gb | 35.58 | 35.58 | 256             | 4              | 1         | 634              | 1299158          | 20299                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 760323072  |
| gpt350m | 2048       | 8       | a100_40gb | 37.77 | 37.77 | 2048            | 8              | 32        | 168              | 344113           | 43014                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 8       | a100_40gb | 37.52 | 37.52 | 1024            | 8              | 16        | 166              | 341842           | 42730                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 8       | a100_40gb | 37.62 | 37.62 | 512             | 8              | 8         | 167              | 342831           | 42853                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 8       | a100_40gb | 37.34 | 37.34 | 256             | 8              | 4         | 166              | 340210           | 42526                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 16      | a100_40gb | 36.83 | 36.83 | 2048            | 8              | 16        | 327              | 671137           | 41946                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 16      | a100_40gb | 36.58 | 36.58 | 1024            | 8              | 8         | 325              | 666661           | 41666                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 16      | a100_40gb | 36.64 | 36.64 | 512             | 8              | 4         | 326              | 667779           | 41736                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 16      | a100_40gb | 36.62 | 36.62 | 256             | 8              | 2         | 325              | 667372           | 41710                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 32      | a100_40gb | 36.13 | 36.13 | 2048            | 8              | 8         | 643              | 1316894          | 41152                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 32      | a100_40gb | 35.94 | 35.94 | 1024            | 8              | 4         | 639              | 1310082          | 40940                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 32      | a100_40gb | 36.21 | 36.21 | 512             | 8              | 2         | 644              | 1319869          | 41245                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 32      | a100_40gb | 35.68 | 35.68 | 256             | 8              | 1         | 635              | 1300518          | 40641                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 64      | a100_40gb | 35.57 | 35.57 | 1024            | 8              | 2         | 1266             | 2593124          | 40517                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 64      | a100_40gb | 35    | 35    | 512             | 8              | 1         | 1245             | 2551575          | 39868                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt350m | 2048       | 64      | a100_40gb | 29.27 | 29.27 | 256             | 4              | 1         | 1041             | 2133414          | 33334                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 355887104  |
| gpt125m | 2048       | 8       | a100_40gb | 31.84 | 31.84 | 2048            | 16             | 16        | 396              | 812783           | 101597               | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 8       | a100_40gb | 31.88 | 31.88 | 1024            | 16             | 8         | 397              | 813735           | 101716               | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 8       | a100_40gb | 31.9  | 31.9  | 512             | 16             | 4         | 397              | 814313           | 101789               | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 8       | a100_40gb | 31.68 | 31.68 | 256             | 16             | 2         | 394              | 808703           | 101087               | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 16      | a100_40gb | 31.42 | 31.42 | 2048            | 16             | 8         | 783              | 1604064          | 100254               | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 16      | a100_40gb | 31.41 | 31.41 | 1024            | 16             | 4         | 782              | 1603181          | 100198               | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 16      | a100_40gb | 31.38 | 31.38 | 512             | 16             | 2         | 782              | 1601984          | 100124               | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 16      | a100_40gb | 30.83 | 30.83 | 256             | 16             | 1         | 768              | 1573714          | 98357                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 32      | a100_40gb | 31.14 | 31.14 | 2048            | 16             | 4         | 1552             | 3179308          | 99353                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 32      | a100_40gb | 31.03 | 31.03 | 1024            | 16             | 2         | 1546             | 3167949          | 98998                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 32      | a100_40gb | 30.54 | 30.54 | 512             | 16             | 1         | 1522             | 3117554          | 97423                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 32      | a100_40gb | 27.77 | 27.77 | 256             | 8              | 1         | 1384             | 2835086          | 88596                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 64      | a100_40gb | 30.23 | 30.23 | 2048            | 16             | 2         | 3014             | 6172908          | 96452                | 4194304             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 64      | a100_40gb | 29.67 | 29.67 | 1024            | 16             | 1         | 2958             | 6059175          | 94674                | 2097152             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 64      | a100_40gb | 26.75 | 26.75 | 512             | 8              | 1         | 2667             | 5462972          | 85358                | 1048576             | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
| gpt125m | 2048       | 64      | a100_40gb | 20.61 | 20.61 | 256             | 4              | 1         | 2054             | 4208218          | 65753                | 524288              | bf16      | DEFAULT | FULL_SHARD        | FALSE                    | FALSE                 | 125237760  |
